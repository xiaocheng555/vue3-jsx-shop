import{g as a,a as s}from"./cart.7e38b868.js";import{a as t}from"./good.9f30feb0.js";import{N as e}from"./index.c77fe791.js";import{b as o,m as l,u as d,r as i,e as n,v as r,f as c,n as u,R as g,U as m,V as v,B as f,W as p,s as C}from"./vendor.6c8c2553.js";/* empty css              */import"./request.324758d0.js";/* empty css              */import{h as x}from"./index.b2344599.js";/* empty css              */import"./index.57763f1b.js";var h={name:"ProductDetail",setup(){const h=o(),y=l(),b=d(),j=i({}),w=i(!1),I=n((()=>b.params.id)),N=n((()=>h.state.cartCount)),k=async()=>{try{w.value=!0;const{goodsId:a}=j.value;await s({goodsCount:1,goodsId:a}),C.success("添加成功"),h.commit("setCartCount",N.value+1)}catch(a){(null==a?void 0:a.resultCode)&&200!==(null==a?void 0:a.resultCode)&&C.fail(a.message||"添加失败"),console.error("商品添加到购物车失败",a)}finally{w.value=!1}},D=()=>{y.push("/cart")};return r((()=>{(async()=>{const a=C.loading("加载中...");try{const s=await t(Number(I.value));j.value=s.data||{}}catch(s){(null==s?void 0:s.resultCode)&&200!==(null==s?void 0:s.resultCode)&&s.message&&C.fail(s.message),console.error("获取商品失败",s)}finally{a.clear()}})(),(async()=>{var s,t;try{const e=await a();(null==(s=e.data)?void 0:s.lengt)&&h.commit("setCartCount",null==(t=e.data)?void 0:t.length)}catch(e){console.error("获取购物车商品失败",e)}})()})),()=>{const{goodsCoverImg:a,goodsName:s,sellingPrice:t,goodsDetailContent:o}=j.value;return c("div",{class:"goods-detail"},[c(e,{title:"商品详情",leftArrow:!0},null),c("img",{class:"goods-detail-img",src:x(a)},null),c("div",{class:"goods-detail-card"},[c("h2",{class:"goods-detail-title"},[s]),c("p",{class:"goods-detail-post"},[u("免邮费 顺丰快递")]),c("div",{class:"goods-detail-price"},[u("¥"),t])]),c(g,null,{default:()=>[c("h3",{class:"goods-detail-subtitle"},[u("商品介绍")])]}),c("div",{class:"goods-detail-content"},[c("div",{innerHTML:o},null)]),c("div",{style:"height: 50px;"},[c(m,null,{default:()=>[c(v,{icon:"chat-o",text:"客服",color:"#ee0a24"},null),c(f,{content:N.value,offset:[-14,0]},{default:()=>[c(v,{icon:"cart-o",text:"购物车",onClick:D},null)]}),c(p,{type:"warning",text:"加入购物车",loading:w.value,onClick:k},null),c(p,{type:"danger",text:"立即购买"},null)]})])])}}};h.__scopeId="data-v-3b20e2d4";export{h as default};
